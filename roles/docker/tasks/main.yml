- name: check if docker is installed
  command: which docker
  ignore_errors: True
  register: result
  changed_when: false
  always_run: yes

- name: run docker install script
  shell: wget -qO- https://get.docker.com/ | sh
  when: result | failed

- name: install docker-py
  pip: name=docker-py state=present

- name: start docker daemon
  service: name=docker state=started

- name: add volume directories
  file:
    dest: "{{ item }}"
    state: directory
    mode: "0777"
  with_items:
    - "{{ volume }}"
    - "{{ movie }}"
    - "{{ tv }}"
    - "{{ download }}"
    - "{{ code }}"
    - "{{ cloud }}"

- name: make docker containers
  include: containers.yml
